%% derniere modif sur Matlab R2013a Linux
clear all;
close all;
clc;

%% ___ donnees ___

% limites
xmin = 20;
ymin = 20;
xmax = 300-xmin;
ymax = 200-ymin;

% rayon robot
rr = 20;

% obstacles
obs = [
% depart
30 100 0 rr;
% gateau
150 200 rr 50;
% verres bleus
90 55 rr 4;
90 105 rr 4;
105 80 rr 4;
135 80 rr 4;
120 55 rr 4;
120 105 rr 4;
% verres rouges
300-90 55 rr 4;
300-90 105 rr 4;
300-105 80 rr 4;
300-135 80 rr 4;
300-120 55 rr 4;
300-120 105 rr 4;
% arrivee
250 50 0 0
];

% path
pth = [
7.995512 100.006470 1.413745;
15.169369 100.927643 9.172270;
22.270771 102.074898 9.206418;
29.928984 103.301971 9.206418;
37.326305 104.484375 9.308863;
44.702297 105.690163 9.397649;
52.085911 106.898384 9.411308;
59.457355 108.108192 9.315692;
66.837906 109.312378 9.343011;
74.216957 110.520996 9.418138;
81.594475 111.727028 9.336182;
88.584496 112.862213 8.175135;
93.768013 112.000809 -27.496320;
97.103836 108.557480 -62.962883;
97.797684 103.435165 -100.676415;
95.688507 96.714943 -108.728613;
93.361458 89.675629 -108.564703;
91.037735 82.621712 -108.687639;
88.686653 75.584991 -108.872041;
86.303520 68.549973 -109.138397;
83.879654 61.531593 -109.630130;
83.287247 50.767117 -58.455293;
87.300362 47.518295 -20.912501;
92.284668 47.381142 16.083912;
96.367996 50.248440 52.650056;
97.949463 54.974506 89.161563;
96.409904 59.692436 125.973578;
91.757957 63.111637 152.390796;
85.110413 66.546242 152.896202;
78.505150 69.970093 152.848391;
71.892288 73.392578 152.848391;
65.268700 76.831306 152.827901;
58.908478 80.116463 152.868882;
52.034969 83.678627 153.012302;
45.403114 87.088463 153.087434;
38.791832 90.472702 153.073774;
32.157272 93.870041 153.189873;
25.524139 97.247238 153.367445;
20.447193 99.789856 153.736247;
20.388920 99.818192 153.804549
];

%% ___ affichage ___

x = 0:300;
theta = 0:pi/50:2*pi;
figure; hold on; axis('equal', [0 300 0 200]);

obs(:,3) = obs(:, 3) + obs(:, 4);

for i=1:size(obs, 1)
	% objets
	plot(obs(i, 1), obs(i, 2), '+b')
	text(obs(i, 1), obs(i, 2), strcat([' ', num2str(i-1)]));
	if obs(i, 4) > 0.01
		plot(obs(i, 4)*cos(theta)+obs(i, 1), obs(i, 4)*sin(theta)+obs(i, 2), 'b');
	end

	% zones interdites objets
%	if obs(i, 3) > obs(i, 4) + 0.01
%		plot(obs(i, 3)*cos(theta)+obs(i, 1), obs(i, 3)*sin(theta)+obs(i, 2), 'r');
%	end
end

vec = 5;
for i=1:size(pth, 1)
	% objets
	plot(pth(i, 1), pth(i, 2), '+k')
	text(pth(i, 1), pth(i, 2), strcat([' ', num2str(i-1)]));
    
    plot([pth(i, 1);pth(i, 1)+vec*cos(pth(i, 3)*pi/180)], [pth(i, 2);pth(i, 2)+vec*sin(pth(i, 3)*pi/180)]);
end

% limites
%plot([xmin; xmax; xmax; xmin; xmin], [ymin; ymin; ymax; ymax; ymin], 'r');
